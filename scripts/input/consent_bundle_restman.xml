<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<l7:Item xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management">
    <l7:Name>Bundle</l7:Name>
    <l7:Type>BUNDLE</l7:Type>
    <l7:TimeStamp>2018-11-07T13:39:36.592Z</l7:TimeStamp>
    <l7:Link rel="self" uri="https://gateway-tst:8443/restman/1.0/bundle?service=e73aa375c92bf77a0b52a366672b0306"/>
    <l7:Resource>
        <l7:Bundle>
            <l7:References>
                <l7:Item>
                    <l7:Name>OTK Security Header Extension</l7:Name>
                    <l7:Id>a5af7a23ab001c063ef535db8188ad65</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.903Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="9f29a8bd-912e-40a5-a48c-3b6f8aa40ac6" id="a5af7a23ab001c063ef535db8188ad65" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="9f29a8bd-912e-40a5-a48c-3b6f8aa40ac6" id="a5af7a23ab001c063ef535db8188ad65" version="0">
                                <l7:Name>OTK Security Header Extension</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;These HTTP headers will always be added to a response from all services&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Authorization Server and OAuth Manager Security Header Extension policies will override values set here for their respective services&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:AddHeader&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;HTTPS only&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Inform the browser to only accept SSL connections&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:HeaderName stringValue=&quot;Content-Security-Policy&quot;/&gt;
            &lt;L7p:HeaderValue stringValue=&quot;default-src 'self'; script-src *.googleapis.com 'unsafe-inline'; img-src * data:; style-src 'unsafe-inline'; font-src * data:;&quot;/&gt;
            &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
        &lt;/L7p:AddHeader&gt;
        &lt;L7p:AddHeader&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;HTTPS only&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Inform the browser to only accept SSL connections&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:HeaderName stringValue=&quot;X-Content-Type-Options&quot;/&gt;
            &lt;L7p:HeaderValue stringValue=&quot;nosniff&quot;/&gt;
            &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
        &lt;/L7p:AddHeader&gt;
        &lt;L7p:AddHeader&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;HTTPS only&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Inform the browser to only accept SSL connections&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:HeaderName stringValue=&quot;X-XSS-Protection&quot;/&gt;
            &lt;L7p:HeaderValue stringValue=&quot;1&quot;/&gt;
            &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
        &lt;/L7p:AddHeader&gt;
        &lt;L7p:AddHeader&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;HTTPS only&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Inform the browser to only accept SSL connections&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Enabled booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:HeaderName stringValue=&quot;Strict-Transport-Security&quot;/&gt;
            &lt;L7p:HeaderValue stringValue=&quot;max-age=31536000; includeSubDomains&quot;/&gt;
            &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
        &lt;/L7p:AddHeader&gt;
        &lt;L7p:AddHeader&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;ClickJacking&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Do not allow overlapping of frames&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Enabled booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:HeaderName stringValue=&quot;X-Frame-Options&quot;/&gt;
            &lt;L7p:HeaderValue stringValue=&quot;Deny&quot;/&gt;
            &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
        &lt;/L7p:AddHeader&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Caching Customization</l7:Name>
                    <l7:Id>c2656fd5ff575252902a7e330e355f53</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.909Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="a2206e7c-28e8-489d-862d-3b7c6da78079" id="c2656fd5ff575252902a7e330e355f53" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="a2206e7c-28e8-489d-862d-3b7c6da78079" id="c2656fd5ff575252902a7e330e355f53" version="0">
                                <l7:Name>OTK Caching Customization</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;This policy gets executed whenever an OTK Cache * assertion is used.&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;This policy can be modified in order to set default configuration values for caches that are introduced.&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;For each cache follow the example shown below:&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;- Add an 'All assertions must evaluate to true' assertion&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;- Check for the cacheID (name) and set values appropriately&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;***** OTK Cache Look Up Customization *****&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Customizable hook for cache lookup.  This is used by OTK Cache Handler as a policy fragment&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Available context variables:&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** cacheID (String) - the ID of the cache to be stored&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** cacheKey - the key associated with the value to be looked up&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** maxEntryAge - the max age in seconds for entries into this cache&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;***** OTK Cache Store Customization *****&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Customizable hook for cache store.  This is used by OTK Cache Handler as a policy fragment, and is called for REMOVE, STORE and FLUSH operations&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Available context variables:&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** cacheID (String) - the ID of the cache to be stored&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** cacheKey - the key associated with the given value for the cache identified by cacheID&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** maxEntries - the maximum number of entries allowed in the cache.  Adding more than this limit would force some existing items to be removed.&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** maxEntryAge - the max age in seconds for entries into this cache&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** maxEntrySize - the maximum size in bytes allowable for the value&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** NOTE:  only one maxEntryAge, maxEntrySize and maxEntries value is supported per cacheID &quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Changing any of these values after the cache has been created will result in the cache configuration being updated.&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
        &lt;/wsp:All&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore L7p:Enabled=&quot;false&quot; wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheID}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;myCache&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;myCache&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${maxEntryAge}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// configure the new lifetime&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MTIwMA==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;maxEntryAge&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;maxEntryAge&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// check if an entryAge has been given&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure number of valid entries&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntries&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure entrySize for cache entries&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAwMDA=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntrySize&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;myCache&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// sample configuration where a given maxEntryAge is accepted but maxEntrySize, maxEntries given in the Cache UI are being ignored&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheID}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;anotherCache&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;anotherCache&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure the new lifetime&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTIwMA==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntryAge&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure number of valid entries&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntries&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure entrySize for cache entries&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAwMDA=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntrySize&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;anotherCache&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// sample configuration where maxEntryAge, maxEntrySize, maxEntries given in the Cache UI are being ignored&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:TrueAssertion/&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;example&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// configure default values per cacheID&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Look Up Customization</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914896</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.910Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="df0a2c11-cf6e-47da-84c0-032bf7f3b6d2" id="161861da3a78c5dcdc62696d16914896" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="df0a2c11-cf6e-47da-84c0-032bf7f3b6d2" id="161861da3a78c5dcdc62696d16914896" version="0">
                                <l7:Name>OTK Cache Look Up Customization</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;***** OTK Cache Look Up Customization *****&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Available context variables:&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** cacheID (String) - the ID of the cache to be stored&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** cacheKey - the key associated with the value to be looked up&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** maxEntryAge - the max age that the cache was originally created with&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Must return:  the variable 'resp' as a Message for found content&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Must fail if the looked up value does not exist!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Replace the assertion below if desired with an assertion that supports key- value data structures&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** If this assertion is replaced also replace it at 'OTK Cache Store Customization'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CacheLookup&gt;
            &lt;L7p:CacheEntryKey stringValue=&quot;${cacheKey}&quot;/&gt;
            &lt;L7p:CacheId stringValue=&quot;${actualCacheID}&quot;/&gt;
            &lt;L7p:ContentTypeOverride stringValue=&quot;&quot;/&gt;
            &lt;L7p:MaxEntryAgeSeconds stringValue=&quot;${maxEntryAge}&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
        &lt;/L7p:CacheLookup&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Store Customization</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914883</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.911Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="2294fc5e-0adf-4d4b-b44d-8d1252f024c9" id="161861da3a78c5dcdc62696d16914883" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="2294fc5e-0adf-4d4b-b44d-8d1252f024c9" id="161861da3a78c5dcdc62696d16914883" version="0">
                                <l7:Name>OTK Cache Store Customization</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;***** OTK Cache Store Customization *****&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Available context variables:&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** cacheID (String) - the ID of the cache to be stored&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** cacheKey - the key associated with the given value for the cache identified by cacheID&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** maxEntries - the maximum number of entries allowed in the cache.  Adding more than this limit would force some existing items to be removed.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** maxEntryAge - the maximum length (seconds) to keep entries in the cache.  &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** maxEntrySize - the maximum size in bytes allowable for the value&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Replace the assertion below if desired with an assertion that support key- value data structures&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** If this assertion is replaced also replace it at 'OTK Cache Look Up Customization'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CacheStorage&gt;
            &lt;L7p:CacheEntryKey stringValue=&quot;${cacheKey}&quot;/&gt;
            &lt;L7p:CacheId stringValue=&quot;${actualCacheID}&quot;/&gt;
            &lt;L7p:MaxEntries stringValue=&quot;${maxEntries}&quot;/&gt;
            &lt;L7p:MaxEntryAgeSeconds stringValue=&quot;${maxEntryAge}&quot;/&gt;
            &lt;L7p:MaxEntrySizeBytes stringValue=&quot;${maxEntrySize}&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;msg&quot;/&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
        &lt;/L7p:CacheStorage&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Handler</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914861</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.920Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="65eff071-9a97-415b-8ebb-8e711ffd738d" id="161861da3a78c5dcdc62696d16914861" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="65eff071-9a97-415b-8ebb-8e711ffd738d" id="161861da3a78c5dcdc62696d16914861" version="0">
                                <l7:Name>OTK Cache Handler</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Required changes can be implemented in policies in the 'Customizations' folder &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === The policies within that folder are named: &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === OTK Caching Customization, OTK Cache Look Up Customization, OTK Cache Store Customization&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you find you cannot add your customizations using the policies in the 'Customizations' folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** OTK Cache Handler *******&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** DO NOT CALL or use this policy directly.  It is included as a Policy Fragment in the following policies:&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** 1. OTK Cache Look Up&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** 2. OTK Cache Store&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** 3. OTK Cache Remove&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** 4. OTK Cache Flush&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** Please use one of the above policies instead&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${maxEntryAge}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// configure default lifetime&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;MzAw&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntryAge&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;maxEntryAge&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check if an maxEntryAge has been given&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${maxEntrySize}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// configure default size in byte&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;MTAwMDA=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntrySize&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;maxEntrySize&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check if an maxEntrySize has been given&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${maxEntries}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// configure default number of entries&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;MTAwMDA=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntries&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;maxEntries&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check if an maxEntries has been given&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;a2206e7c-28e8-489d-862d-3b7c6da78079&quot;/&gt;
        &lt;/L7p:Include&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtjYWNoZUlEfSR7bWF4RW50cnlBZ2V9&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;actualCacheID&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cache.op}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue=&quot;df0a2c11-cf6e-47da-84c0-032bf7f3b6d2&quot;/&gt;
                &lt;/L7p:Include&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cache.op}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${cache.op}&quot;/&gt;
                        &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;FLUSH&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MA==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;maxEntryAge&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;== SET&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// maxEntryAge to 0 for FLUSH operation&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:Include&gt;
                        &lt;L7p:PolicyGuid stringValue=&quot;2294fc5e-0adf-4d4b-b44d-8d1252f024c9&quot;/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// STORE, REMOVE, FLUSH&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;operations&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Look Up</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914bbb</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.929Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="fb88be42-83e7-4d36-a865-34e53d4f4218" id="161861da3a78c5dcdc62696d16914bbb" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="fb88be42-83e7-4d36-a865-34e53d4f4218" id="161861da3a78c5dcdc62696d16914bbb" version="0">
                                <l7:Name>OTK Cache Look Up</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;***** OTK Cache Look Up ********************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Looks up a cache value from the cache identified by cacheID and maxEntryAge by key: cacheKey.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheID}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheKey}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${maxEntryAge}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;valid&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAz&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;validate&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check for required fields&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;R0VU&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;cache.op&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntries&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntrySize&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;== SET&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// context variables for OTK Cache Handler&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:All&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;65eff071-9a97-415b-8ebb-8e711ffd738d&quot;/&gt;
        &lt;/L7p:Include&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Look Up</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914c21</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.932Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="161861da3a78c5dcdc62696d16914c21" version="0">
                            <l7:Name>OTK Cache Look Up</l7:Name>
                            <l7:Guid>68ad78a1-f4a1-4568-91e1-0980d95c75cd</l7:Guid>
                            <l7:PolicyReference id="161861da3a78c5dcdc62696d16914bbb" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>cacheID</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>The Cache ID (required)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>cacheKey</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>The Cache Key (identifier) for this entry (required)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>maxEntryAge</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Max. entry age in seconds (optional if a default value exists)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>custom</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Custom</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>custom_data</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Looks Up an item associated with key: cacheKey in cache with ID: cacheID and returns it in values, if the item exists. </l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>customAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>lookup16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="passMetricsToParent">
                                    <l7:StringValue>false</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>fb88be42-83e7-4d36-a865-34e53d4f4218</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>#OTK Fail with error message</l7:Name>
                    <l7:Id>bc9a31b7578652a08a514d7d4fef9afd</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.934Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="1a55cc2a-9996-4978-8473-c2a75e5c59d1" id="bc9a31b7578652a08a514d7d4fef9afd" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="1a55cc2a-9996-4978-8473-c2a75e5c59d1" id="bc9a31b7578652a08a514d7d4fef9afd" version="0">
                                <l7:Name>#OTK Fail with error message</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Target Configuration Policy: &amp;quot;OTK Fail with error message&amp;quot;&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Set custom values for Context Variables below ===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Set Context Variables to override their values in the target policy below ===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Customizations:&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;DO NOT CHANGE OR OVERWRITE EXISTING ERROR CODES!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Add error codes as desired! Follow the existing pattern!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Create any code in the 700-899 range!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;custom&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;custom&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJjdXN0b21fZXJyb3IiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJDdXN0b20gZXJyb3IgZGVzY3JpcHRpb24iDQp9&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:RaiseError/&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;== custom&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// custom error handling&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Store</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914be5</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.944Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="58143e14-a1cd-4cca-b25a-e2d637a42bbc" id="161861da3a78c5dcdc62696d16914be5" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="58143e14-a1cd-4cca-b25a-e2d637a42bbc" id="161861da3a78c5dcdc62696d16914be5" version="0">
                                <l7:Name>OTK Cache Store</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;***** OTK Cache Store *********************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Stores the given msg in the cache identified by cacheID and maxEntryAge with key: cacheKey.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheID}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheKey}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${maxEntryAge}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${maxEntries}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${maxEntrySize}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;valid&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAz&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;validate&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check for required fields&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;U1RPUkU=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;cache.op&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;== SET&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// context variables for OTK Cache Handler&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:All&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;65eff071-9a97-415b-8ebb-8e711ffd738d&quot;/&gt;
        &lt;/L7p:Include&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Store</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914c44</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.944Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="161861da3a78c5dcdc62696d16914c44" version="0">
                            <l7:Name>OTK Cache Store</l7:Name>
                            <l7:Guid>e5ee8bcf-1796-4297-88dd-c838031a6f6a</l7:Guid>
                            <l7:PolicyReference id="161861da3a78c5dcdc62696d16914be5" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>cacheID</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>The Cache ID (required)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>cacheKey</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>The Cache Key (identifier) for this entry (required)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>maxEntries</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Max. number of entries for this cache (optional if a default value exists)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>maxEntryAge</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Max. entry age in seconds (optional if a default value exists)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>maxEntrySize</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Max. size for each entry (optional if a default value exists)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>6</l7:Ordinal>
                                    <l7:ArgumentName>msg</l7:ArgumentName>
                                    <l7:ArgumentType>message</l7:ArgumentType>
                                    <l7:GuiLabel>The message to be cached (required, must exist in the preceeding policy context)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>7</l7:Ordinal>
                                    <l7:ArgumentName>custom</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Custom</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>custom_data</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Writes an item to cache with ID: cacheID with key: cacheKey.  If the cache does not exist, one will be created.  If the key exists, the existing item will be overwritten.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>customAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconBase64">
                                    <l7:StringValue>R0lGODlhEAAQAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/&#xD;
/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#xD;
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm&#xD;
AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/&#xD;
MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm&#xD;
ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/&#xD;
mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm&#xD;
zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/&#xD;
/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ&#xD;
AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA&#xD;
M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ&#xD;
ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A&#xD;
mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z&#xD;
zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAAQABAA&#xD;
AAhWAFGg+EewoEGDAgceXEgwYUOGCAX+UwixocOKBS9OlBjxIop+/PpRZPgxZMiRBwWCFIkS4amE&#xD;
Lyui4IeqDyqOJE/xexkT4syaN1tm1MlTaEagRjsWDAgAOw==</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="passMetricsToParent">
                                    <l7:StringValue>false</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>58143e14-a1cd-4cca-b25a-e2d637a42bbc</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Fail with error message</l7:Name>
                    <l7:Id>d1bde3d2021a469e82ebf8cac288bbd1</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.987Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="9e864ce5-1275-477f-a642-b5e867f367a3" id="d1bde3d2021a469e82ebf8cac288bbd1" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="9e864ce5-1275-477f-a642-b5e867f367a3" id="d1bde3d2021a469e82ebf8cac288bbd1" version="0">
                                <l7:Name>OTK Fail with error message</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Required changes can be implemented in policies in the 'Customizations' folder &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === The policies within that folder will have the same name as this policy but &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === either prefixed with '#' or suffixed with 'Extensions'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Prefixed policies can be used to overwrite variables of this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Suffixed policies can be used to extend functionality&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you find you cannot add your customizations using the policies in the 'Customizations' folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy should be used as an encapsulated assertion&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;OTK has error responses configured that are specified here&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;OTK policies pass in an error code and this encapsulated assertion will return appropriate errors&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;cache errors for performance reasons&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ZmFpbEVycm9yTWVzc2FnZUNhY2hl&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;cacheName&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;remember if a value if cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;isCached&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:HandleErrors L7p:Usage=&quot;Required&quot;
            includeIOException=&quot;false&quot; variablePrefix=&quot;errors&quot;&gt;
            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;From cache&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;68ad78a1-f4a1-4568-91e1-0980d95c75cd&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Cache Look Up&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;cacheID&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${cacheName}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${givenErrorCode}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;maxAcceptableAge&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;300&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;maxEntryAge&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;300&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLm1haW5wYXJ0fQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;cacheValue&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                        &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:CaptureVar stringValue=&quot;errordetail&quot;/&gt;
                        &lt;L7p:OtherTargetMessageVariable stringValue=&quot;cacheValue&quot;/&gt;
                        &lt;L7p:Regex stringValue=&quot;status([0-9]{1,10})description(.+)&quot;/&gt;
                        &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtlcnJvcmRldGFpbFsxXX0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtlcnJvcmRldGFpbFsyXX0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;remember if a value if cache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;isCached&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;from cache&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue=&quot;1a55cc2a-9996-4978-8473-c2a75e5c59d1&quot;/&gt;
                &lt;/L7p:Include&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;CA Mobile API Gateway related&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;15795857-d8a2-4b45-9722-94fc1ce9098a&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;MAG Fail with error message&quot;/&gt;
                        &lt;L7p:NoOpIfConfigMissing booleanValue=&quot;true&quot;/&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.msg}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;OAuth token validation related&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;990&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;990&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJWYWxpZGF0aW9uIGVycm9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;990&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;expired or unknown token&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;991&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;991&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJWYWxpZGF0aW9uIGVycm9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;991&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;missing SCOPE, permissions&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;992&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;992&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJWYWxpZGF0aW9uIGVycm9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;992&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;no or multiple access_token were provided&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;993&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;993&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJWYWxpZGF0aW9uIGVycm9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;993&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;disabled token&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;OAuth authorization page related&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;114&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;114&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlZGlyZWN0X3VyaSIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6Ik9uZSBvciBtb3JlIHJlZGlyZWN0X3VyaSB2YWx1ZXMgYXJlIGludmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;114&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;mismatching redirect uri&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;123&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;123&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ewogICJlcnJvciI6ImF1dGhlbnRpY2F0aW9uX2Vycm9yIiwKICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVzb3VyY2Vfb3duZXIgY2FuY2VsbGVkIGF1dGhlbnRpY2F0aW9uIgp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;123&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;resource owner denied authentication&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;124&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;124&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJhY2Nlc3NfZGVuaWVkIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIHJlc291cmNlX293bmVyIGRlbmllZCBhY2Nlc3MgdG8gcmVzb3VyY2VzIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;124&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;resource owner denied access to resources&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;110&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;110&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgc2Vzc2lvbiBoYXMgZXhwaXJlZCBvciBhbHJlYWR5IGJlZW4gZ3JhbnRlZC4gVGhlIGxvZ2luIHByb2Nlc3MgaGFzIHRvIGJlIHJlcGVhdGVkIHRvIGJlIHN1Y2Nlc3NmdWwiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;110&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid session&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Authentication related&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;201&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;201&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX2NsaWVudCIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6IlRoZSBnaXZlbiBjbGllbnQgY3JlZGVudGlhbHMgd2VyZSBub3QgdmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;201&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid client related&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;202&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;202&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJsb2dpbl9yZXF1aXJlZCIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6IlRoZSByZXNvdXJjZSBvd25lciBjb3VsZCBub3QgYmUgYXV0aGVudGljYXRlZCBkdWUgdG8gbWlzc2luZyBvciBpbnZhbGlkIGNyZWRlbnRpYWxzIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;202&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid resource owner credentials&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;203&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;203&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAz&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJTU0wgaXMgcmVxdWlyZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;203&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Missing SSL&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;204&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;204&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAz&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJTU0wgd2l0aCBjbGllbnQgYXV0aGVudGljYXRpb24gaXMgcmVxdWlyZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;204&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Missing SSL and/or client certificate&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;205&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;205&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsDQogImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGNsaWVudCBjZXJ0aWZpY2F0ZSBpcyBub3QgdmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;205&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid client certificate&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Others&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;103&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;103&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue=&quot;no parameters or duplicate parameters or a missing required parameters&quot;/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJNaXNzaW5nIG9yIGR1cGxpY2F0ZSBwYXJhbWV0ZXJzIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid parameter related&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;111&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;111&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue=&quot;The number of requests has exceeded the accepted limit&quot;/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDI5&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgbnVtYmVyIG9mIHBlcm1pdHRlZCByZXF1ZXN0cyBoYXMgYmVlbiBleGNlZWRlZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;111&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;too many requests&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;112&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;112&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue=&quot;either an invalid code_challenge or code_challenge_method&quot;/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJ0aGUgY29kZV9jaGFsbGVuZ2Ugb3IgY29kZV9jaGFsbGVuZ2VfbWV0aG9kIGlzIGludmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;112&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid PKCE parameter&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;113&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;113&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX2dyYW50IiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGdpdmVuIGdyYW50IGlzIGludmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;113&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid grant&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;115&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;115&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3Njb3BlIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiTm8gcmVnaXN0ZXJlZCBzY29wZSB2YWx1ZSBmb3IgdGhpcyBjbGllbnQgaGFzIGJlZW4gcmVxdWVzdGVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;115&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;no matching registered SCOPE&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;116&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;116&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJ1bnN1cHBvcnRlZF9yZXNwb25zZV90eXBlIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiTm9uZSBvZiB0aGUgc3VwcG9ydGVkIHJlc3BvbnNlX3R5cGVzIHdlcmUgdXNlZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;116&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unsupported response type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;117&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;117&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJ1bmF1dGhvcml6ZWRfY2xpZW50IiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGNsaWVudCBtaXNzZXMgYXV0aG9yaXphdGlvbiBmb3IgdGhpcyByZXF1ZXN0Ig0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;117&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;missing client authorization&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;118&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;118&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAz&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJ1bnN1cHBvcnRlZF90b2tlbl90eXBlIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoidGhlIGdpdmVuIHR5cGUgb2YgdG9rZW4gaXMgbm90IHN1cHBvcnRlZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;118&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unsupported token type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;119&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;119&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJ1bnN1cHBvcnRlZF9ncmFudF90eXBlIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGdpdmVuIGdyYW50X3R5cGUgaXMgbm90IHN1cHBvcnRlZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;119&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unsupported grant_type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;120&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;120&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgaWRfdG9rZW4gaGFzIG1pc3NpbmcgY2xhaW1zIG9yIGhhcyBleHBpcmVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;120&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid id_token&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;121&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;121&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZ2l2ZW4gSldUIGlzIGludmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;121&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid JWT&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;122&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;122&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgSldUIC0gaWRfdG9rZW4gY291bGQgbm90IGJlIGNyZWF0ZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;122&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;JWT - id_token could not be created&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;300&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;300&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJDbGllbnQoX2lkKSB2YWx1ZSBjb3VsZCBub3QgYmUgcGVyc2lzdGVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;300&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;client_id could not be persisted&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;301&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;301&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgdmFsdWUgZm9yICdwZXJzaXN0X3R5cGUnIGlzIG5vdCBzdXBwb3J0ZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;301&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unknown persist_type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;303&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;303&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcGF0aCBjb21wb25lbnQgb2YgdGhlIFVSTCBpcyBpbnZhbGlkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;303&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invald path&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;304&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;304&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MzAy&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJjb25zZW50X3JlcXVpcmVkIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGF1dGhvcml6YXRpb24gc2VydmVyIHJlcXVpcmVzIHVzZXIgY29uc2VudCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;304&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;consent required&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;125&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;125&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJBIHZlcmlmaWVyIGhhcyBhbHJlYWR5IGJlZW4gc2V0Ig0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;125&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid verifier&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;126&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;126&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZ2l2ZW4gc3RhdHVzIGRvZXMgbm90IG1hdGNoIHRoZSBhY3R1YWwgY2xpZW50IHN0YXR1cyINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;126&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid client_id status&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;127&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;127&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZ2l2ZW4gY2xpZW50X2lkIGhhcyBleHBpcmVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;127&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;expired client_id&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;128&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;128&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgY2xpZW50IG5hbWUgaXMgbm90IHZhbGlkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;128&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid client name&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;129&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;129&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZW52aXJvbm1lbnQgaXMgbm90IHZhbGlkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;129&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid environment&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;130&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;130&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgY2xpZW50IHR5cGUgaXMgbm90IHZhbGlkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;130&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid client type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;131&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;131&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgaWRfdG9rZW4gY291bGQgbm90IGJlIGNyZWF0ZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;131&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;id_token error&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;132&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;132&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgc2VydmVyIGNvbmZpZ3VyYXRpb24gaXMgaW52YWxpZC4gQ29udGFjdCB0aGUgYWRtaW5pc3RyYXRvciINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;132&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid server configuration&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;133&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;133&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZ2l2ZW4gbWVzc2FnZSBpcyBub3QgYSB2YWxpZCBKU09OIG9iamVjdCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;133&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid JSON object&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;134&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;134&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVxdWVzdCBkaWQgbm90IG1hdGNoIENPUlMgcmVxdWlyZW1lbnRzIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;134&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;CORS requirements did not match&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;135&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;135&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgbWF4aW11bSBudW1iZXIgb2YgdG9rZW5zIGhhcyBiZWVuIHJlYWNoZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;135&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Max number of OAuth Sessions reached&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;136&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;136&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX2NvbmZpZ3VyYXRpb24iLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcHVibGljIGtleSBoYXNoIGNvdWxkIG5vdCBiZSBjcmVhdGVkLiBDb250YWN0IHRoZSBhZG1pbmlzdHJhdG9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;136&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// public key hash could not be created&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;305&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;305&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkIGp3a3MgYW5kIGp3a3NfdXJpIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGp3a3NfdXJpIGFuZCBqd2tzIHBhcmFtZXRlcnMgTVVTVCBOT1QgYmUgdXNlZCB0b2dldGhlci4iDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;305&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// both jwks and jwks_uri are provided at OIDC registration&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;306&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;306&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkIGNsaWVudCIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6IlRoZSBnaXZlbiBKV1QgZm9yIGNsaWVudCBhdXRoZW50aWNhdGlvbiBpcyBpbnZhbGlkLiINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;306&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// client jwt for client authentication is invalid&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;307&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;307&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX2NsaWVudCIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6IlJlcXVlc3QgaXMgYSByZXBsYXkgYXR0YWNrLiINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;307&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// request is a replay attack&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;308&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;308&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX2NsaWVudCIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6IlJlcGxheSBhdHRhY2sgcHJvdGVjdGlvbiBjb3VsZCBub3QgYmUgYXBwbGllZC4iDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;308&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// replay attack protection could not be applied&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;000&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;000&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVxdWVzdCBmYWlsZWQgZHVlIHRvIHNvbWUgdW5rbm93biByZWFzb24iDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;000&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unknown server side error&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue=&quot;An unknown or empty error code was given: Given: API-Prefix: '${apiPrefix}', error code: '${givenErrorCode}'. Setting it to '000'&quot;/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;override&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set to '000' since none was given&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;givenErrorCode&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVxdWVzdCBmYWlsZWQgZHVlIHRvIHNvbWUgdW5rbm93biByZWFzb24iDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;no matching&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;the given error code is not handled&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Find the appropriate error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:OneOrMore&gt;
        &lt;/L7p:HandleErrors&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${isCached}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;c3RhdHVzJHtzdGF0dXN9ZGVzY3JpcHRpb24ke2Vycm9yLm1zZ30=&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;cacheValue&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;e5ee8bcf-1796-4297-88dd-c838031a6f6a&quot;/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Cache Store&quot;/&gt;
                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;cacheID&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${cacheName}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;doNotCacheSoapFaults&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;true&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;maxEntries&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;100&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;maxEntryAge&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;300&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;maxEntrySize&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;10000&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;msg&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;cacheValue&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;cache the error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:TrueAssertion/&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;or not to cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHthcGlQcmVmaXh9JHtnaXZlbkVycm9yQ29kZX0=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:FalseAssertion/&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Fail with error message</l7:Name>
                    <l7:Id>d1bde3d2021a469e82ebf8cac288bd97</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:35.987Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="d1bde3d2021a469e82ebf8cac288bd97" version="0">
                            <l7:Name>OTK Fail with error message</l7:Name>
                            <l7:Guid>56bd8147-3ab4-4d09-9460-8b2de02b7a9e</l7:Guid>
                            <l7:PolicyReference id="d1bde3d2021a469e82ebf8cac288bbd1" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>givenErrorCode</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Error code</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>apiPrefix</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>API prefix for error code</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>custom</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Custom</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>custom_data</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>status</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>This assertion returns an error message, http status and content-type value associated with the given 'Error code'.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Error_Handling</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_apiPrefix">
                                    <l7:StringValue>A value combined with the given error code. If, for example, an API would be identifiedby the values '1234' and the given error code is '111' the exported variable 'error.code' would contain '1234111'</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_givenErrorCode">
                                    <l7:StringValue>A value associated with a certain error. If that value is unkown it will be replaced with '000' within the output variable 'error.code'</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Stop16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>9e864ce5-1275-477f-a642-b5e867f367a3</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Require SSL (with Client Certificate)</l7:Name>
                    <l7:Id>d1bde3d2021a469e82ebf8cac288b778</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:36.494Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="b598a733-5faf-439a-9aaf-088ca73d102e" id="d1bde3d2021a469e82ebf8cac288b778" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="b598a733-5faf-439a-9aaf-088ca73d102e" id="d1bde3d2021a469e82ebf8cac288b778" version="0">
                                <l7:Name>OTK Require SSL (with Client Certificate)</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This fragment should be used as an encapsulated assertion&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This fragment will require SSL and optionally a client certificate&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;The fragment will create an error message and an http status code&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Thie policy should be used at the beginning of an API policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;When OTK/MAG gets installed this policy is used at endpoint the the /storage and /ovp folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${requireClientCert}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;boolean&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SslAssertion&gt;
                    &lt;L7p:RequireClientAuthentication booleanValue=&quot;true&quot;/&gt;
                &lt;/L7p:SslAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Mutual SSL&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;requires SSL and a client certificate&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${requireClientCert}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;boolean&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SslAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;SSL&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;requires SSL&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${requireClientCert}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;boolean&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${apiPrefix}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;204&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;204&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${requireClientCert}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;boolean&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;203&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${apiPrefix}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;203&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;203&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;With with error code 203 or 204&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:OneOrMore&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Require TLS&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Require SSL (with Client Certificate)</l7:Name>
                    <l7:Id>d1bde3d2021a469e82ebf8cac288b7c9</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:36.494Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="d1bde3d2021a469e82ebf8cac288b7c9" version="0">
                            <l7:Name>OTK Require SSL (with Client Certificate)</l7:Name>
                            <l7:Guid>47f768f4-b478-472b-a1ee-10f4b6e76f99</l7:Guid>
                            <l7:PolicyReference id="d1bde3d2021a469e82ebf8cac288b778" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>requireClientCert</l7:ArgumentName>
                                    <l7:ArgumentType>boolean</l7:ArgumentType>
                                    <l7:GuiLabel>Require Client Certificate</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>apiPrefix</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>API prefix for error code</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>custom</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Custom</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>custom_data</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>status</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Requires a request to use SSL and optionally present a client certificate. It is not authenticating the client, just requiring its certificate.
                    Use this encapsulated assertion at the beginning of the API policy. Preced 'OTK FIP Client Authentication' with this assertion.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Access_Control</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>ssl.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>b598a733-5faf-439a-9aaf-088ca73d102e</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK HTTP Method Validation</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd946</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:36.496Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="6aa2d277-b510-44e2-88ef-31ff01840c28" id="e001cfd0c1c1ffaa18e187b5e72fd946" version="0">
                            <l7:PolicyDetail folderId="739ec70735e715be8161d39043d23717" guid="6aa2d277-b510-44e2-88ef-31ff01840c28" id="e001cfd0c1c1ffaa18e187b5e72fd946" version="0">
                                <l7:Name>OTK HTTP Method Validation</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;MjAw&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHttZXRob2R9&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;http_method_allowed&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAubWV0aG9kfQ==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;http_method_used&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:Split&gt;
            &lt;L7p:IgnoreEmptyValues booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:InputVariable stringValue=&quot;method&quot;/&gt;
            &lt;L7p:OutputVariable stringValue=&quot;method&quot;/&gt;
            &lt;L7p:SplitPattern stringValue=&quot;|&quot;/&gt;
            &lt;L7p:SplitPatternRegEx booleanValue=&quot;false&quot;/&gt;
        &lt;/L7p:Split&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:Expression1 stringValue=&quot;${method}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;${request.http.method}&quot;/&gt;
                &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;ANY&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:RightValue stringValue=&quot;${request.http.method}&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;NDA1&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;ew0KICAgICAgICAgICAgICAgICJlcnJvciI6ImludmFsaWRfbWV0aG9kIiwNCiAgICAgICAgICAgICAgICAiZXJyb3JfZGVzY3JpcHRpb24iOiIke3JlcXVlc3QuaHR0cC5tZXRob2R9IG5vdCBwZXJtaXR0ZWQiDQogICAgICAgICAgICAgICAgfQ=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue=&quot;ALLOW&quot;/&gt;
                    &lt;L7p:HeaderValue stringValue=&quot;${method}&quot;/&gt;
                    &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                &lt;/L7p:AddHeader&gt;
                &lt;L7p:FalseAssertion/&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK HTTP Method Validation</l7:Name>
                    <l7:Id>3f6b5c92ca2ac3665bc7d8780bc4d876</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:36.496Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="3f6b5c92ca2ac3665bc7d8780bc4d876" version="0">
                            <l7:Name>OTK HTTP Method Validation</l7:Name>
                            <l7:Guid>b8822449-71ff-455b-8f10-39122e6c549b</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd946" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>method</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Valid HTTP Method (...|...)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>custom</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Custom</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>custom_data</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>http_method_allowed</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>http_method_used</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>status</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Validates the used HTTP method.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Access_Control</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_method">
                                    <l7:StringValue>A pipe separated list of accepted http methods</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>validate.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="passMetricsToParent">
                                    <l7:StringValue>false</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>6aa2d277-b510-44e2-88ef-31ff01840c28</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>auth/oauth/v2/authorize/consent</l7:Name>
                    <l7:Id>e73aa375c92bf77a0b52a366672b0306</l7:Id>
                    <l7:Type>SERVICE</l7:Type>
                    <l7:TimeStamp>2018-11-07T13:39:36.591Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Service id="e73aa375c92bf77a0b52a366672b0306" version="2">
                            <l7:ServiceDetail folderId="af166f3fe1c8bff95a5fff928eace0ac" id="e73aa375c92bf77a0b52a366672b0306" version="2">
                                <l7:Name>auth/oauth/v2/authorize/consent</l7:Name>
                                <l7:Enabled>true</l7:Enabled>
                                <l7:ServiceMappings>
                                    <l7:HttpMapping>
                                        <l7:UrlPattern>/auth/oauth/v2/authorize/consent</l7:UrlPattern>
                                        <l7:Verbs>
                                            <l7:Verb>GET</l7:Verb>
                                            <l7:Verb>POST</l7:Verb>
                                            <l7:Verb>PUT</l7:Verb>
                                            <l7:Verb>PATCH</l7:Verb>
                                            <l7:Verb>DELETE</l7:Verb>
                                            <l7:Verb>HEAD</l7:Verb>
                                            <l7:Verb>OPTIONS</l7:Verb>
                                            <l7:Verb>OTHER</l7:Verb>
                                        </l7:Verbs>
                                    </l7:HttpMapping>
                                </l7:ServiceMappings>
                                <l7:Properties>
                                    <l7:Property key="internal">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                    <l7:Property key="policyRevision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                    <l7:Property key="tracingEnabled">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                    <l7:Property key="wssProcessingEnabled">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:ServiceDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy" version="0">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== *** THIS POLICY IS OVERWRITTEN DURING AN UPGRADE ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Be aware that custom configuration made in this policy is overwritten during a solution kit upgrade.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== However, the older version of the policy is kept in the history and can be referenced.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== After upgrade, manually merge customizations from the old version of the policy to the new version.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy issues an authorization grant or an token for 'token' response_type&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CustomizeErrorResponse&gt;
            &lt;L7p:Content stringValue=&quot;${error.msg}&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;${content-type}&quot;/&gt;
            &lt;L7p:ExtraHeaders nameValuePairArray=&quot;included&quot;&gt;
                &lt;L7p:item nameValuePair=&quot;included&quot;&gt;
                    &lt;L7p:Key stringValue=&quot;Cache-Control&quot;/&gt;
                    &lt;L7p:Value stringValue=&quot;no-store&quot;/&gt;
                &lt;/L7p:item&gt;
                &lt;L7p:item nameValuePair=&quot;included&quot;&gt;
                    &lt;L7p:Key stringValue=&quot;Pragma&quot;/&gt;
                    &lt;L7p:Value stringValue=&quot;no-cache&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:ExtraHeaders&gt;
            &lt;L7p:HttpStatus stringValue=&quot;${status}&quot;/&gt;
        &lt;/L7p:CustomizeErrorResponse&gt;
        &lt;L7p:Encapsulated&gt;
            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;fbbc4f7d-cd06-41f3-8011-695bfad1d80b&quot;/&gt;
            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Configuration&quot;/&gt;
        &lt;/L7p:Encapsulated&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;9f29a8bd-912e-40a5-a48c-3b6f8aa40ac6&quot;/&gt;
        &lt;/L7p:Include&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;initialize&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;will be overridden in the case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;initialize&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;will be overridden in the case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmFjdGlvbn0=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;action&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlc3Npb25JRH0=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;sessionID&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlc3Npb25EYXRhfQ==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;sessionDataJWT&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlc3BvbnNlX3R5cGV9&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;response_type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlc3BvbnNlX21vZGV9&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;response_mode&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:Encapsulated&gt;
                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;2be8eaf2-9b42-4173-ace9-3fdb471fb407&quot;/&gt;
                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;API XSS Protection&quot;/&gt;
                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;allinput&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;${request.mainpart}${request.url}&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Parameters&gt;
            &lt;/L7p:Encapsulated&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;json response&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;return json error response&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;other&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;task&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;L7p:FalseAssertion&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;return false&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;stop processing the whole policy&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                &lt;/L7p:FalseAssertion&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:Encapsulated&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;API-ID 3002&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;47f768f4-b478-472b-a1ee-10f4b6e76f99&quot;/&gt;
                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Require SSL (with Client Certificate)&quot;/&gt;
                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;requireClientCert&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;false&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Parameters&gt;
            &lt;/L7p:Encapsulated&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                    &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                &lt;/L7p:AddHeader&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;SSL&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Require SSL&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:Encapsulated&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;POST&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;b8822449-71ff-455b-8f10-39122e6c549b&quot;/&gt;
                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK HTTP Method Validation&quot;/&gt;
                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;method&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;POST&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Parameters&gt;
            &lt;/L7p:Encapsulated&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Method&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Checking the HTTP method&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:HtmlFormDataAssertion&gt;
                    &lt;L7p:AllowGet booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:AllowPost booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:FieldSpecs htmlFormFieldSpecArray=&quot;included&quot;&gt;
                        &lt;L7p:item htmlFormFieldSpec=&quot;included&quot;&gt;
                            &lt;L7p:AllowEmpty boxedBooleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:DataType fieldDataType=&quot;any&quot;/&gt;
                            &lt;L7p:MaxOccurs intValue=&quot;1&quot;/&gt;
                            &lt;L7p:MinOccurs intValue=&quot;1&quot;/&gt;
                            &lt;L7p:Name stringValue=&quot;action&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item htmlFormFieldSpec=&quot;included&quot;&gt;
                            &lt;L7p:AllowEmpty boxedBooleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:DataType fieldDataType=&quot;any&quot;/&gt;
                            &lt;L7p:MaxOccurs intValue=&quot;1&quot;/&gt;
                            &lt;L7p:MinOccurs intValue=&quot;1&quot;/&gt;
                            &lt;L7p:Name stringValue=&quot;sessionID&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:FieldSpecs&gt;
                &lt;/L7p:HtmlFormDataAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAuaGVhZGVydmFsdWVzLm1hZy1pZGVudGlmaWVyfEBAfSMj&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;requestHeaders&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Presence of '@@' indicates duplicate parameters&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;requestHeaders&quot;/&gt;
                    &lt;L7p:ProceedIfPatternMatches booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Regex stringValue=&quot;[@]{2}|[,]&quot;/&gt;
                    &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;API-ID 3002&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:AddHeader&gt;
                        &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                        &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                        &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;get the error message&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:OneOrMore&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Parameters&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Check for duplicate parameters in the request&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${action}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;consent&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;consent&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:HtmlFormDataAssertion&gt;
                        &lt;L7p:AllowPost booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:FieldSpecs htmlFormFieldSpecArray=&quot;included&quot;&gt;
                            &lt;L7p:item htmlFormFieldSpec=&quot;included&quot;&gt;
                                &lt;L7p:AllowEmpty boxedBooleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:DataType fieldDataType=&quot;any&quot;/&gt;
                                &lt;L7p:MaxOccurs intValue=&quot;1&quot;/&gt;
                                &lt;L7p:MinOccurs intValue=&quot;1&quot;/&gt;
                                &lt;L7p:Name stringValue=&quot;sessionData&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:FieldSpecs&gt;
                    &lt;/L7p:HtmlFormDataAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;API-ID 3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;L7p:AddHeader&gt;
                                &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                                &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                            &lt;/L7p:AddHeader&gt;
                            &lt;L7p:FalseAssertion/&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;get the error message&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Parameters&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Check for duplicate parameters in the request&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;sessionID&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Make sure the session is still available&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;4e4bc164-3fa2-4b15-ba65-31cef45b84b0&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session GET&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheAge&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${sessionIdCacheAge}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheId&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;authorizeCache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${sessionID}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;sessionValue&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:found/ns:value/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-session&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:DecodeJsonWebToken&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;decrypt&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:SignatureSecret stringValue=&quot;${otk_session_secret_encryption}&quot;/&gt;
                            &lt;L7p:SourcePayload stringValue=&quot;${sessionDataJWT}&quot;/&gt;
                            &lt;L7p:TargetVariablePrefix stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:ValidationType stringValue=&quot;Using Secret&quot;/&gt;
                        &lt;/L7p:DecodeJsonWebToken&gt;
                        &lt;L7p:DecodeJsonWebToken&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;validate signature&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:SignatureSecret stringValue=&quot;${otk_session_secret}&quot;/&gt;
                            &lt;L7p:SourcePayload stringValue=&quot;${sessionData.plaintext}&quot;/&gt;
                            &lt;L7p:TargetVariablePrefix stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:ValidationType stringValue=&quot;Using Secret&quot;/&gt;
                        &lt;/L7p:DecodeJsonWebToken&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// Verify the signature validation result&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${sessionData.valid}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtzZXNzaW9uRGF0YS5wYXlsb2FkfQ==&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;application/json;charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;sessionData&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.sessionID&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;sessionIDJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.exp&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;expJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.current_username&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;resourceOwnerJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${sessionID}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;${sessionIDJWT.result}&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${sessionIDJWT.result}&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${expJWT.result}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;${gateway.time.seconds}&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;GE&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;GE&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${gateway.time.seconds}&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resourceOwnerJWT.result}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;none&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;none&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;request_parameters.client_id&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;request_param.client_id&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;request_parameters.prompt&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;request_param.prompt&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;request_consent.client_name&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;clientNameJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;request_consent.scope_verified&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;scopeJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;clientNameJWT.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;client_name&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;scopeJWT.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;scope&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtzZXNzaW9uRGF0YS5tYWlucGFydH0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;sessionData&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Regex&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;consent&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;updating the sessionData to include an active consent&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Regex stringValue=&quot;current_user_consent&amp;quot;:[\s]?&amp;quot;none&amp;quot;&quot;/&gt;
                            &lt;L7p:Replace booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Replacement stringValue=&quot;current_user_consent&amp;quot;:&amp;quot;requested&amp;quot;&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:Regex&gt;
                        &lt;L7p:EncodeJsonWebToken&gt;
                            &lt;L7p:ContentEncryptionAlgorithm stringValue=&quot;A128CBC-HS256&quot;/&gt;
                            &lt;L7p:EncryptPayload booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:EncryptionSecret stringValue=&quot;${otk_session_secret_encryption}&quot;/&gt;
                            &lt;L7p:KeyManagementAlgorithm stringValue=&quot;dir&quot;/&gt;
                            &lt;L7p:SignPayload booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:SignatureAlgorithm stringValue=&quot;HS256&quot;/&gt;
                            &lt;L7p:SignatureSecretKey stringValue=&quot;${otk_session_secret}&quot;/&gt;
                            &lt;L7p:SourceVariable stringValue=&quot;${sessionData}&quot;/&gt;
                            &lt;L7p:TargetVariable stringValue=&quot;jwt_session&quot;/&gt;
                        &lt;/L7p:EncodeJsonWebToken&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtqd3Rfc2Vzc2lvbi5jb21wYWN0fQ==&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;sessionDataJWT&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNvdXJjZU93bmVySldULnJlc3VsdH0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;resource_owner&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Access the values stored in the cache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;110&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;API-ID 3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;110&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;isLogin&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;false&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;other&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;other_for_consent&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;task&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;L7p:AddHeader&gt;
                                &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                                &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                            &lt;/L7p:AddHeader&gt;
                            &lt;L7p:FalseAssertion/&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error response&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;get the error message&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;session data&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;check for valid session&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;other&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;task&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;consent&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;200&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue=&quot;JHtjb250ZW50fQ==&quot;/&gt;
                    &lt;L7p:ResponseContentType stringValue=&quot;${content-type}&quot;/&gt;
                &lt;/L7p:HardcodedResponse&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;consent&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Request consent screen after successful login at '.../authorize/login'&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${action}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;grant&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;grant&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:HtmlFormDataAssertion&gt;
                        &lt;L7p:AllowPost booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:FieldSpecs htmlFormFieldSpecArray=&quot;included&quot;&gt;
                            &lt;L7p:item htmlFormFieldSpec=&quot;included&quot;&gt;
                                &lt;L7p:AllowEmpty boxedBooleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:DataType fieldDataType=&quot;any&quot;/&gt;
                                &lt;L7p:MaxOccurs intValue=&quot;1&quot;/&gt;
                                &lt;L7p:MinOccurs intValue=&quot;1&quot;/&gt;
                                &lt;L7p:Name stringValue=&quot;sessionData&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:FieldSpecs&gt;
                    &lt;/L7p:HtmlFormDataAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;API-ID 3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;L7p:AddHeader&gt;
                                &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                                &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                            &lt;/L7p:AddHeader&gt;
                            &lt;L7p:FalseAssertion/&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;get the error message&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Parameters&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Check for duplicate parameters in the request&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:DecodeJsonWebToken&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;decrypt&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:SignatureSecret stringValue=&quot;${otk_session_secret_encryption}&quot;/&gt;
                            &lt;L7p:SourcePayload stringValue=&quot;${sessionDataJWT}&quot;/&gt;
                            &lt;L7p:TargetVariablePrefix stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:ValidationType stringValue=&quot;Using Secret&quot;/&gt;
                        &lt;/L7p:DecodeJsonWebToken&gt;
                        &lt;L7p:DecodeJsonWebToken&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;validate signature&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:SignatureSecret stringValue=&quot;${otk_session_secret}&quot;/&gt;
                            &lt;L7p:SourcePayload stringValue=&quot;${sessionData.plaintext}&quot;/&gt;
                            &lt;L7p:TargetVariablePrefix stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:ValidationType stringValue=&quot;Using Secret&quot;/&gt;
                        &lt;/L7p:DecodeJsonWebToken&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// Verify the signature validation result&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${sessionData.valid}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtzZXNzaW9uRGF0YS5wYXlsb2FkfQ==&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;application/json;charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;sessionData&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.sessionID&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;sessionIDJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.exp&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;expJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.current_username&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;resourceOwnerJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.current_user_consent&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;consentJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${sessionID}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;${sessionIDJWT.result}&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${sessionIDJWT.result}&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${expJWT.result}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;${gateway.time.seconds}&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;GE&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;GE&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${gateway.time.seconds}&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resourceOwnerJWT.result}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;none&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;none&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;consent&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;'active' if the user had an active oauth session, 'requested' if consent was requested&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${consentJWT.result}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item regex=&quot;included&quot;&gt;
                                    &lt;L7p:Pattern stringValue=&quot;active|requested&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNvdXJjZU93bmVySldULnJlc3VsdH0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;resource_owner&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.salt&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;salt&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.current_user_acr&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;current.user.acr&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.current_user_authTime&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;current.user.authTime&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.current_user_consent&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;consentJWT&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.third_party_sso_token&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;third_party_sso_token&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;session.third_party_sso_token_type&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;third_party_sso_token_type&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:EvaluateJsonPathExpression&gt;
                            &lt;L7p:Expression stringValue=&quot;request_parameters.max_age&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;sessionData&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;request_param.max_age&quot;/&gt;
                        &lt;/L7p:EvaluateJsonPathExpression&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0X3BhcmFtLm1heF9hZ2UucmVzdWx0fQ==&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;max_age&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;4e4bc164-3fa2-4b15-ba65-31cef45b84b0&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session GET&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheAge&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${sessionIdCacheAge}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheId&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;authorizeCache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${sessionID}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;sessionValue&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:found/ns:value/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-session&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;sessionValue.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;decoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtkZWNvZGVkfQ==&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;grantedContent&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeClientName&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/clientName/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeClientIdent&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/client_ident/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeClientID&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/client_id/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeRedirectURI&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/redirect_uri/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeGivenRedirectURI&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/given_redirect_uri&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeResponseType&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/response_type/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeResponseMode&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/response_mode&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeClientType&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/client_type/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeClientCustom&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/client_custom&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeClientKeyCustom&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/client_key_custom&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeScope&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/scope/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeState&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/state&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeOidcNonce&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/oidcNonce&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeCodeChallenge&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/codeChallenge&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeCodeChallengeMethod&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/codeChallengeMethod&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Mobile SSO&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeMagIdentifier&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/expected_mag_identifier&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Mobile SSO&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeDeviceUserDomain&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/expected_device_user_domain&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Mobile SSO&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeDeviceUser&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/expected_device_user&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;authorizeClientName.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeClientNameDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;authorizeClientIdent.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeClientIdentDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;authorizeClientID.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeClientIDDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;authorizeRedirectURI.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeRedirectURIDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;authorizeResponseType.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeResponseTypeDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;authorizeResponseMode.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeResponseModeDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;authorizeScope.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeScopeDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVTdGF0ZS5yZXN1bHR9&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;state&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;state&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeStateDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVDbGllbnRUeXBlLnJlc3VsdH0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;authorizeClientTypeDecoded&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVDbGllbnRDdXN0b20ucmVzdWx0fQ==&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;authorizeClientCustomDecoded&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVDbGllbnRLZXlDdXN0b20ucmVzdWx0fQ==&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;authorizeClientKeyCustomDecoded&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVPaWRjTm9uY2UucmVzdWx0fQ==&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;oidcNonce&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVDb2RlQ2hhbGxlbmdlLnJlc3VsdH0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;authorizeCodeChallenge&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVDb2RlQ2hhbGxlbmdlTWV0aG9kLnJlc3VsdH0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;authorizeCodeChallengeMethod&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Mobile SSO&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVNYWdJZGVudGlmaWVyLnJlc3VsdH0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;expected-mag-identifier&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Mobile SSO&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVEZXZpY2VVc2VyRG9tYWluLnJlc3VsdH0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;expected-device-user-domain&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Mobile SSO&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVEZXZpY2VVc2VyLnJlc3VsdH0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;expected-device-user&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;8d06714c-d54c-48e5-a454-e3c036b67f98&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session - Delete&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheAge&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${sessionIdCacheAge}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheId&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;authorizeCache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${sessionID}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheMaxEntries&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;10000&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheMaxSize&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;10000&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Access the values stored in the cache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;110&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;API-ID 3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;110&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;L7p:AddHeader&gt;
                                &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                                &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                            &lt;/L7p:AddHeader&gt;
                            &lt;L7p:FalseAssertion/&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error response&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;get the error message&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;session data&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Get granted values&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;=== Verify that the authenticated user is the expected one for the device&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;No device given&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${expected-mag-identifier}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;No user expected&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;In a multi user scenario any user can use the device&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${expected-device-user}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;SocialLogin&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Typical case would be something like: 'facebook-MyFacebookName'&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resource_owner&quot;/&gt;
                        &lt;L7p:PatternContainsVariables booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Regex stringValue=&quot;${expected-device-user-domain}.?${expected-device-user}&quot;/&gt;
                        &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Mobile SSO&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${max_age}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;0&quot;/&gt;
                            &lt;L7p:ExpressionIsVariable booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtjdXJyZW50LnVzZXIuYXV0aFRpbWUucmVzdWx0fQ==&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                            &lt;L7p:DateOffsetExpression stringValue=&quot;${max_age}&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;time_limit&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtnYXRld2F5LnRpbWUuc2Vjb25kc30=&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                            &lt;L7p:DateOffsetExpression stringValue=&quot;&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;current_time&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${time_limit}&quot;/&gt;
                            &lt;L7p:ExpressionIsVariable booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;dateTime&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${current_time}&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtjdXJyZW50X3RpbWUuc2Vjb25kc30=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;current.user.authTime.result&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;max_age was passed, auth_time set to current time&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;set auth_time in accordance to max_age&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseTypeDecoded}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;code&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;code&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${expected-mag-identifier}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtzYWx0fSR7ZXhwZWN0ZWQtZGV2aWNlLWlkZW50aWZpZXJ9&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;salt&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtzYWx0fSR7YXV0aG9yaXplQ2xpZW50SUREZWNvZGVkfQ==&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;salt&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Salt&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Use the mag-identifier to generate 'salt' if it exists, the client_id otherwise!&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;df04db76-9431-40b2-872f-dd0ab9727d19&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session Tracking&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;clientkey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_custom&amp;quot;: ${authorizeClientCustomDecoded},&amp;quot;client_key_custom&amp;quot;: ${authorizeClientKeyCustomDecoded}}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;current_input&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;customer&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientKeyCustomDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;mag&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_type&amp;quot;: &amp;quot;${authorizeClientTypeDecoded}&amp;quot;,&amp;quot;grant_type&amp;quot;: &amp;quot;authorization_code&amp;quot;,&amp;quot;code_challenge&amp;quot;: &amp;quot;${authorizeCodeChallenge}&amp;quot;,&amp;quot;code_challenge_method&amp;quot;: &amp;quot;${authorizeCodeChallengeMethod}&amp;quot;}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;portal&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;31fe6887-927d-4f26-9bd7-cfd98fa3281c&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK response_type=CODE&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;acr&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.acr.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;authTime&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.authTime.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIdentDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_name&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientNameDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${session_output}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;expected-mag-identifier&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${expected-mag-identifier}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;max_age&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${max_age}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;nonce&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${oidcNonce}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;redirect_uri&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeRedirectURIDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;resource_owner&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${resource_owner}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;response_mode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;salt&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${salt.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;scope&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeScopeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token_type&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token_type.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Access was granted: response_type=code&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseTypeDecoded}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;token&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;df04db76-9431-40b2-872f-dd0ab9727d19&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session Tracking&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;clientkey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_custom&amp;quot;: ${authorizeClientCustomDecoded},&amp;quot;client_key_custom&amp;quot;: ${authorizeClientKeyCustomDecoded}}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;current_input&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;customer&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;mag&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_type&amp;quot;: &amp;quot;${authorizeClientTypeDecoded}&amp;quot;,&amp;quot;grant_type&amp;quot;: &amp;quot;implicit&amp;quot;}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;portal&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;192bf141-6a60-4108-a56c-84abf7c136fe&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK response_type=TOKEN&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIdentDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_name&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientNameDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${session_output}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;redirect_uri&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeRedirectURIDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;resource_owner&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${resource_owner}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;response_mode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;scope&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeScopeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;token_status&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;ENABLED&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Access was granted: response_type=token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseTypeDecoded}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item regex=&quot;included&quot;&gt;
                                    &lt;L7p:Pattern stringValue=&quot;(token.id_token)|(id_token.token)&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;df04db76-9431-40b2-872f-dd0ab9727d19&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session Tracking&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;clientkey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_custom&amp;quot;: ${authorizeClientCustomDecoded},&amp;quot;client_key_custom&amp;quot;: ${authorizeClientKeyCustomDecoded}}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;current_input&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;customer&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;mag&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_type&amp;quot;: &amp;quot;${authorizeClientTypeDecoded}&amp;quot;,&amp;quot;grant_type&amp;quot;: &amp;quot;implicit&amp;quot;}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;portal&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;2dd2c0ca-6d4f-49fc-8b0a-eae14c10a940&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK response_type=TOKEN ID_TOKEN&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;acr&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.acr.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;authTime&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.authTime.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;azp&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientID.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIdentDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_name&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientNameDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${session_output}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;nonce&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${oidcNonce}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;redirect_uri&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeRedirectURIDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;resource_owner&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${resource_owner}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;response_mode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;salt&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${salt}${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;scope&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeScopeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token_type&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token_type.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;token_status&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;ENABLED&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Access was granted: response_type=token id_token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseTypeDecoded}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item regex=&quot;included&quot;&gt;
                                    &lt;L7p:Pattern stringValue=&quot;(code.id_token)|(id_token.code)&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;df04db76-9431-40b2-872f-dd0ab9727d19&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session Tracking&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;clientkey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_custom&amp;quot;: ${authorizeClientCustomDecoded},&amp;quot;client_key_custom&amp;quot;: ${authorizeClientKeyCustomDecoded}}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;current_input&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;customer&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientKeyCustomDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;mag&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_type&amp;quot;: &amp;quot;${authorizeClientTypeDecoded}&amp;quot;,&amp;quot;grant_type&amp;quot;: &amp;quot;authorization_code, implicit&amp;quot;,&amp;quot;code_challenge&amp;quot;: &amp;quot;${authorizeCodeChallenge}&amp;quot;,&amp;quot;code_challenge_method&amp;quot;: &amp;quot;${authorizeCodeChallengeMethod}&amp;quot;}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;portal&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;e29dee85-31ea-4631-afa3-a98e12ae458d&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK response_type=CODE ID_TOKEN&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;acr&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.acr.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;authTime&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.authTime.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;azp&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientID.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIdentDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_name&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientNameDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${session_output}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;nonce&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${oidcNonce}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;redirect_uri&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeRedirectURIDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;resource_owner&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${resource_owner}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;response_mode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;salt&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${salt}${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;scope&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeScopeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token_type&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token_type.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Access was granted: response_type=code id_token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseTypeDecoded}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;id_token&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;id_token&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;df04db76-9431-40b2-872f-dd0ab9727d19&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session Tracking&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;clientkey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_custom&amp;quot;: ${authorizeClientCustomDecoded},&amp;quot;client_key_custom&amp;quot;: ${authorizeClientKeyCustomDecoded}}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;current_input&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;customer&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientKeyCustomDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;mag&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_type&amp;quot;: &amp;quot;${authorizeClientTypeDecoded}&amp;quot;,&amp;quot;grant_type&amp;quot;: &amp;quot;implicit&amp;quot;}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;portal&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;a3cf6e14-921d-4706-8df2-0077fa4d9033&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK response_type=ID_TOKEN&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;acr&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.acr.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;authTime&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.authTime.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;azp&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientID.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIdentDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_name&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientNameDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${session_output}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;nonce&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${oidcNonce}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;redirect_uri&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeRedirectURIDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;resource_owner&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${resource_owner}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;response_mode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;salt&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${salt}${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;scope&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeScopeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token_type&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token_type.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Access was granted: response_type=id_token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseTypeDecoded}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;code token&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;code token&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${expected-mag-identifier}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtzYWx0fSR7ZXhwZWN0ZWQtZGV2aWNlLWlkZW50aWZpZXJ9&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;salt&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtzYWx0fSR7YXV0aG9yaXplQ2xpZW50SUREZWNvZGVkfQ==&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;salt&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Salt&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Use the mag-identifier to generate 'salt' if it exists, the client_id otherwise!&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;df04db76-9431-40b2-872f-dd0ab9727d19&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session Tracking&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;clientkey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_custom&amp;quot;: ${authorizeClientCustomDecoded},&amp;quot;client_key_custom&amp;quot;: ${authorizeClientKeyCustomDecoded}}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;current_input&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;customer&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientKeyCustomDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;mag&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_type&amp;quot;: &amp;quot;${authorizeClientTypeDecoded}&amp;quot;,&amp;quot;grant_type&amp;quot;: &amp;quot;authorization_code&amp;quot;,&amp;quot;code_challenge&amp;quot;: &amp;quot;${authorizeCodeChallenge}&amp;quot;,&amp;quot;code_challenge_method&amp;quot;: &amp;quot;${authorizeCodeChallengeMethod}&amp;quot;}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;portal&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;db18acab-4fc2-4d0d-a25f-b7d27c5ee4be&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK response_type=CODE TOKEN&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;acr&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.acr.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;authTime&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.authTime.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIdentDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_name&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientNameDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${session_output}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;expected-mag-identifier&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${expected-mag-identifier}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;max_age&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${max_age}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;nonce&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${oidcNonce}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;redirect_uri&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeRedirectURIDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;resource_owner&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${resource_owner}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;response_mode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;salt&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${salt.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;scope&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeScopeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token_type&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token_type.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;token_status&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;ENABLED&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Access was granted: response_type=code token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseTypeDecoded}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item regex=&quot;included&quot;&gt;
                                    &lt;L7p:Pattern stringValue=&quot;(code.id_token.token)|(code.token.id_token)|(id_token.code.token)|(id_token.token.code)|(token.id_token.code)|(token.code.id_token)&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;df04db76-9431-40b2-872f-dd0ab9727d19&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session Tracking&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;clientkey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_custom&amp;quot;: ${authorizeClientCustomDecoded},&amp;quot;client_key_custom&amp;quot;: ${authorizeClientKeyCustomDecoded}}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;current_input&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;customer&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientKeyCustomDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;mag&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;{&amp;quot;client_type&amp;quot;: &amp;quot;${authorizeClientTypeDecoded}&amp;quot;,&amp;quot;grant_type&amp;quot;: &amp;quot;authorization_code, implicit&amp;quot;,&amp;quot;code_challenge&amp;quot;: &amp;quot;${authorizeCodeChallenge}&amp;quot;,&amp;quot;code_challenge_method&amp;quot;: &amp;quot;${authorizeCodeChallengeMethod}&amp;quot;}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;portal&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;df451c36-c915-4faa-af40-9e9f7aa5ddc2&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK response_type=CODE ID_TOKEN TOKEN&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;acr&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.acr.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;authTime&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${current.user.authTime.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;azp&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientID.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIdentDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_name&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeClientNameDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${session_output}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;expected-mag-identifier&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${expected-mag-identifier}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;max_age&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${max_age}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;nonce&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${oidcNonce}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;redirect_uri&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeRedirectURIDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;resource_owner&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${resource_owner}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;response_mode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;salt&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${salt}${authorizeClientIDDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;scope&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${authorizeScopeDecoded}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;third_party_sso_token_type&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${third_party_sso_token_type.result}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;token_status&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;ENABLED&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Access was granted: response_type=code id_token token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code is provide by response_type assertion, API-ID 3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;L7p:AddHeader&gt;
                                &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                                &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                            &lt;/L7p:AddHeader&gt;
                            &lt;L7p:FalseAssertion/&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error response&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;get the error message&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;response_type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Decide whether to issue an access_token or an authorization_code&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeState.result}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;form_post&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;form_post&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtmb3JtUmVzcH0NCiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSINCiAgICAgdmFsdWU9IiR7YXV0aG9yaXplU3RhdGUucmVzdWx0fSIvPg==&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;formResp&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// form_post&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtsb2NhdGlvbn0mc3RhdGU9JHthdXRob3JpemVTdGF0ZS5yZXN1bHR9&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;location&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                        &lt;/wsp:OneOrMore&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;add state parameter if sent in request message&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseTypeDecoded}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;code&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;code&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeScopeDecoded}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;form_post&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;form_post&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtmb3JtUmVzcH0NCiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzY29wZSINCiAgICAgdmFsdWU9IiR7YXV0aG9yaXplU2NvcGUucmVzdWx0fSIvPg==&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;formResp&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// form_post&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtsb2NhdGlvbn0mc2NvcGU9JHthdXRob3JpemVTY29wZS5yZXN1bHR9&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;location&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                        &lt;/wsp:OneOrMore&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;add scope parameter if sent in request message&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeResponseModeDecoded}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;form_post&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;form_post&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;PGh0bWw+DQogPGhlYWQ+PHRpdGxlPlN1Ym1pdCBUaGlzIEZvcm08L3RpdGxlPjwvaGVhZD4NCiA8Ym9keSBvbmxvYWQ9ImphdmFzY3JpcHQ6ZG9jdW1lbnQuZm9ybXNbMF0uc3VibWl0KCkiPiR7Zm9ybVJlc3B9DQogIDwvZm9ybT4NCiA8L2JvZHk+DQo8L2h0bWw+&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:HardcodedResponse&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;200&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Auto post form with parameters&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:Base64ResponseBody stringValue=&quot;JHtyZXNwfQ==&quot;/&gt;
                            &lt;L7p:ResponseContentType stringValue=&quot;text/html;charset=UTF-8&quot;/&gt;
                        &lt;/L7p:HardcodedResponse&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// form_post&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:HardcodedResponse&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;302&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Redirect back to the client&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:ResponseContentType stringValue=&quot;text/html;charset=UTF-8&quot;/&gt;
                            &lt;L7p:ResponseStatus stringValue=&quot;302&quot;/&gt;
                        &lt;/L7p:HardcodedResponse&gt;
                        &lt;L7p:AddHeader&gt;
                            &lt;L7p:HeaderName stringValue=&quot;Location&quot;/&gt;
                            &lt;L7p:HeaderValue stringValue=&quot;${location}&quot;/&gt;
                            &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                        &lt;/L7p:AddHeader&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;send request message&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:AddHeader&gt;
                        &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                        &lt;L7p:HeaderValue stringValue=&quot;3002${error.code}&quot;/&gt;
                        &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;check error.code&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;grant&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Access was granted&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${action}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;deny&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;deny&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;4e4bc164-3fa2-4b15-ba65-31cef45b84b0&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session GET&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheAge&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${sessionIdCacheAge}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheId&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;authorizeCache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${sessionID}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;sessionValue&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:found/ns:value/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-session&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;sessionValue.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;decoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtkZWNvZGVkfQ==&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;grantedContent&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeRedirectURI&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/redirect_uri/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;authorizeState&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/state&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xpathResponseMode&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;grantedContent&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/authorize/response_mode/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;authorizeRedirectURI.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeRedirectURIDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;authorizeState.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;authorizeStateDecoded&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;xpathResponseMode.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;response_mode&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;124&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;API-ID 3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:AssertionComment&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;124&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtlcnJvci5tc2d9&quot;/&gt;
                                    &lt;L7p:ContentType stringValue=&quot;application/json;charset=UTF-8&quot;/&gt;
                                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;jsonMsg&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:EvaluateJsonPathExpression&gt;
                                    &lt;L7p:Expression stringValue=&quot;error&quot;/&gt;
                                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;jsonMsg&quot;/&gt;
                                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:EvaluateJsonPathExpression&gt;
                                &lt;L7p:EvaluateJsonPathExpression&gt;
                                    &lt;L7p:Expression stringValue=&quot;error_description&quot;/&gt;
                                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;jsonMsg&quot;/&gt;
                                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;error_description&quot;/&gt;
                                &lt;/L7p:EvaluateJsonPathExpression&gt;
                                &lt;L7p:EncodeDecode&gt;
                                    &lt;L7p:SourceVariableName stringValue=&quot;error.result&quot;/&gt;
                                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                                    &lt;L7p:TargetVariableName stringValue=&quot;error_type_encoded&quot;/&gt;
                                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                                &lt;/L7p:EncodeDecode&gt;
                                &lt;L7p:EncodeDecode&gt;
                                    &lt;L7p:SourceVariableName stringValue=&quot;error_description.result&quot;/&gt;
                                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                                    &lt;L7p:TargetVariableName stringValue=&quot;error_description_encoded&quot;/&gt;
                                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                                &lt;/L7p:EncodeDecode&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtlcnJvci5yZXN1bHR9&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;error_type&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtlcnJvcl9kZXNjcmlwdGlvbi5yZXN1bHR9&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;error_description&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;ZXJyb3I9JHtlcnJvcl90eXBlX2VuY29kZWR9JmVycm9yX2Rlc2NyaXB0aW9uPSR7ZXJyb3JfZGVzY3JpcHRpb25fZW5jb2RlZH0meC1jYS1lcnI9JHtlcnJvci5jb2RlfQ==&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;path&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;action denied&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;get the error message&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${response_mode}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;fragment&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${authorizeRedirectURIDecoded}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;#&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;#&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JiR7cGF0aH0=&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;location&quot;/&gt;
                                    &lt;/L7p:SetVariable&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;send error as new fragment or attach to existing&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                    &lt;/wsp:All&gt;
                                    &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9IyR7cGF0aH0=&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;location&quot;/&gt;
                                    &lt;/L7p:SetVariable&gt;
                                &lt;/wsp:OneOrMore&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;response_mode=fragment&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${response_mode}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;query&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${authorizeRedirectURIDecoded}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;?&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;?&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JiR7cGF0aH0=&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;location&quot;/&gt;
                                    &lt;/L7p:SetVariable&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;send error as new query or attach to existing&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                    &lt;/wsp:All&gt;
                                    &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9PyR7cGF0aH0=&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;location&quot;/&gt;
                                    &lt;/L7p:SetVariable&gt;
                                &lt;/wsp:OneOrMore&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;response_mode=query&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${response_mode}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;form_post&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;PGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT5FcnJvciBSZXNwb25zZTwvdGl0bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5IG9ubG9hZD0iamF2YXNjcmlwdDpkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+DQogICAgICAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSIke2F1dGhvcml6ZVJlZGlyZWN0VVJJRGVjb2RlZH0iPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iZXJyb3IiIHZhbHVlPSIke2Vycm9yX3R5cGV9Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJlcnJvcl9kZXNjcmlwdGlvbiIgdmFsdWU9IiR7ZXJyb3JfZGVzY3JpcHRpb259Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJ4LWNhLWVyciIgdmFsdWU9IiR7ZXJyb3IuY29kZX0iLz4NCiAgICAgICAgPC9mb3JtPg0KICAgIDwvYm9keT4NCjwvaHRtbD4=&quot;/&gt;
                                    &lt;L7p:ContentType stringValue=&quot;text/xml; charset=utf-8&quot;/&gt;
                                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;response&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:HardcodedResponse&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;400&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;no redirect&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:Base64ResponseBody stringValue=&quot;JHtyZXNwb25zZX0=&quot;/&gt;
                                    &lt;L7p:EarlyResponse booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:ResponseContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
                                    &lt;L7p:ResponseStatus stringValue=&quot;400&quot;/&gt;
                                &lt;/L7p:HardcodedResponse&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;response_mode=form_post&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;location&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;build location&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;session lookup&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Get the redirect URI and state value&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;110&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code is provide by authentication assertion, API-ID 3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;110&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;L7p:AddHeader&gt;
                                &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                                &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                            &lt;/L7p:AddHeader&gt;
                            &lt;L7p:FalseAssertion/&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error response&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;get the error message, session has expired&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;302 or HTML&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Create the redirect location&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;8d06714c-d54c-48e5-a454-e3c036b67f98&quot;/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Session - Delete&quot;/&gt;
                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;cacheAge&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${sessionIdCacheAge}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;cacheId&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;authorizeCache&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${sessionID}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;cacheMaxEntries&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;10000&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;cacheMaxSize&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;10000&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${authorizeStateDecoded}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtsb2NhdGlvbn0mc3RhdGU9JHthdXRob3JpemVTdGF0ZS5yZXN1bHR9&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;location&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;state&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;add state parameter if sent in request message&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;302&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Redirect&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:ResponseContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
                    &lt;L7p:ResponseStatus stringValue=&quot;302&quot;/&gt;
                &lt;/L7p:HardcodedResponse&gt;
                &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue=&quot;Location&quot;/&gt;
                    &lt;L7p:HeaderValue stringValue=&quot;${location}&quot;/&gt;
                    &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                &lt;/L7p:AddHeader&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;deny&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Access was denied&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${sessionID}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${action}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:AuditDetailAssertion&gt;
                                &lt;L7p:Detail stringValue=&quot;action but no session&quot;/&gt;
                            &lt;/L7p:AuditDetailAssertion&gt;
                            &lt;L7p:FalseAssertion/&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;action, no session&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Invalid combination of parameters was used&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${sessionID}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${action}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:AuditDetailAssertion&gt;
                                &lt;L7p:Detail stringValue=&quot;no action but session&quot;/&gt;
                            &lt;/L7p:AuditDetailAssertion&gt;
                            &lt;L7p:FalseAssertion/&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;no action, session&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Invalid combination of parameters was used&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;API-ID 3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:AssertionComment&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:Encapsulated&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Parameters&gt;
                                &lt;/L7p:Encapsulated&gt;
                                &lt;L7p:AddHeader&gt;
                                    &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                                    &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                                    &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                                &lt;/L7p:AddHeader&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error response&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;get the error message&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;parameters&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;wrong parameter combination&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue=&quot;Something went totally wrong!&quot;/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;000&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;API-ID 3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:AssertionComment&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;3002&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;000&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:Encapsulated&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;09faa5d6-e22c-4d4d-812d-32603331c136&quot;/&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Authorization Server Website Template&quot;/&gt;
                                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${errorDetail}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;error.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.msg}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;new.content&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Parameters&gt;
                                &lt;/L7p:Encapsulated&gt;
                                &lt;L7p:AddHeader&gt;
                                    &lt;L7p:HeaderName stringValue=&quot;x-ca-err&quot;/&gt;
                                    &lt;L7p:HeaderValue stringValue=&quot;${error.code}&quot;/&gt;
                                    &lt;L7p:RemoveExisting booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                                &lt;/L7p:AddHeader&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error response&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;get the error message&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;unknown&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;something unknown happened&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;error type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Unknown action&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Tasks&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Service>
                    </l7:Resource>
                </l7:Item>
            </l7:References>
            <l7:Mappings>
                <l7:Mapping action="Ignore" type="ENCAPSULATED_ASSERTION">
                    <l7:Properties>
                        <l7:Property key="MapBy">
                            <l7:StringValue>guid</l7:StringValue>
                        </l7:Property>
                        <l7:Property key="MapTo">
                            <l7:StringValue>fbbc4f7d-cd06-41f3-8011-695bfad1d80b</l7:StringValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="739ec70735e715be8161d39043d23717" srcUri="https://gateway-tst:8443/restman/1.0/folders/739ec70735e715be8161d39043d23717" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="a5af7a23ab001c063ef535db8188ad65" srcUri="https://gateway-tst:8443/restman/1.0/policies/a5af7a23ab001c063ef535db8188ad65" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="c2656fd5ff575252902a7e330e355f53" srcUri="https://gateway-tst:8443/restman/1.0/policies/c2656fd5ff575252902a7e330e355f53" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914896" srcUri="https://gateway-tst:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914896" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914883" srcUri="https://gateway-tst:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914883" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914861" srcUri="https://gateway-tst:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914861" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914bbb" srcUri="https://gateway-tst:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914bbb" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914c21" srcUri="https://gateway-tst:8443/restman/1.0/encapsulatedAssertions/161861da3a78c5dcdc62696d16914c21" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="bc9a31b7578652a08a514d7d4fef9afd" srcUri="https://gateway-tst:8443/restman/1.0/policies/bc9a31b7578652a08a514d7d4fef9afd" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914be5" srcUri="https://gateway-tst:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914be5" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914c44" srcUri="https://gateway-tst:8443/restman/1.0/encapsulatedAssertions/161861da3a78c5dcdc62696d16914c44" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="d1bde3d2021a469e82ebf8cac288bbd1" srcUri="https://gateway-tst:8443/restman/1.0/policies/d1bde3d2021a469e82ebf8cac288bbd1" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="d1bde3d2021a469e82ebf8cac288bd97" srcUri="https://gateway-tst:8443/restman/1.0/encapsulatedAssertions/d1bde3d2021a469e82ebf8cac288bd97" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="d1bde3d2021a469e82ebf8cac288b778" srcUri="https://gateway-tst:8443/restman/1.0/policies/d1bde3d2021a469e82ebf8cac288b778" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="d1bde3d2021a469e82ebf8cac288b7c9" srcUri="https://gateway-tst:8443/restman/1.0/encapsulatedAssertions/d1bde3d2021a469e82ebf8cac288b7c9" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd946" srcUri="https://gateway-tst:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd946" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="3f6b5c92ca2ac3665bc7d8780bc4d876" srcUri="https://gateway-tst:8443/restman/1.0/encapsulatedAssertions/3f6b5c92ca2ac3665bc7d8780bc4d876" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="af166f3fe1c8bff95a5fff928eace0ac" srcUri="https://gateway-tst:8443/restman/1.0/folders/af166f3fe1c8bff95a5fff928eace0ac" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="e73aa375c92bf77a0b52a366672b0306" srcUri="https://gateway-tst:8443/restman/1.0/services/e73aa375c92bf77a0b52a366672b0306" type="SERVICE"/>
            </l7:Mappings>
        </l7:Bundle>
    </l7:Resource>
</l7:Item>